extends layout
block content
  // slick-slider
  - var today = new Date();
  - var month = today.getMonth() + 1;
  .full-cover-pzfutball
  .container-fluid.bg-light
    .container
      .main-slider
        .d-flex.justify-content-center
          .d-none.d-sm-block
            .title-wrap.left
              h3 General Game
              h1 일반매치
              a(href='#')
                img.mx-auto(src='/images/lets_go.png')
            img(src='/images/pz_main_slide_01.png', alt='pc')
          .mobile_slide.w-100.d-block.d-sm-none(style='background:url(/images/main_slide_1_m.png)')
          
          //- img.w-100.d-block.d-sm-none(src='/images/main_slide_1_m.png', alt='m')
          //- .d-flex.justify-content-center
          //-   .d-none.d-sm-block
          //-     .title-wrap.right
          //-       h3 League Game
          //-       h1 리그 매치
          //-       a(href='#')
          //-         img.mx-auto(src='/images/lets_go.png')
          //-     img(src='/images/pz_main_slide_02.png', alt='pc')
          //-   .mobile_slide.w-100.d-block.d-sm-none(style='background:url(/images/main_slide_2_m.png)')
        .d-flex.justify-content-center
          .d-none.d-sm-block
            .title-wrap.rank-title.center
              h4 #{today.getFullYear()}.#{month < 10 ? '0' + month:month}
              h2 순위표 바로가기
              .text-light /
              h5 Go to then Rank
              a(href='#')
                img.mx-auto.mt-3(src='/images/lets_go.png')
            img(src='/images/pz_main_slide_03.png', alt='pc')
          .mobile_slide.w-100.d-block.d-sm-none(style='background:url(/images/main_slide_3_m.png)')
  // 달력선택 부분
  - var size = 28;
  - var day = ['일', '월', '화', '수', '목', '금', '토'];
  .navigation
    nav.d-flex.justify-content-center.w-100(style='z-index:5')
      .container-fluid.py-1.bg-white
        .mx-auto.d-flex.justify-content-between.mobile-menu-wrap
          //- .game-icons-wrap.mx-auto(style='width:230px;')
          //-   button.btn.btn-link.p-0.mr-3(type='button', data-game='2')
          //-     img(src='/images/game_2match.png', alt='2파전')
          //-   button.btn.btn-link.p-0.mr-3(type='button', data-game='3', style='top:-16px; position:relative;')
          //-     img(src='/images/game_3match.png', alt='3파전')
          //-   button#dropdownGroundList.btn.btn-link.p-0(href='#', role='button',data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
          //-     img(src='/images/game_ground.png', alt='구장')
          //-     .dropdown-menu.p-0(aria-labelledby='dropdownGroundList')
          //-       ul.list-group.list-group-flush
          //-         li.list-group-item.list-group-item-action(data-id='') 전체
          //-         each ground in ground_list
          //-           a(href='#')
          //-             li.list-group-item.list-group-item-action(data-id=ground._id) #{ground.groundName}
          .calendar-slider.w-100.mx-auto(style='max-width:750px;')
            - var d = 0;
            while d < size
              //.col
              .pr-2
                - var date = new Date();
                - date.setDate(today.getDate() + d++)
                button.btn.rounded.btn-date.font-italic.w-100.btn-link(type='button', onclick='fnSelectDate(this)',
                class=d===1?'active':'',
                class=date.getDay()===0?'text-danger':date.getDay()===6?'text-primary':'text-secondary',
                class=d===1?'btn-primary':'', data-date=date.toISOString().slice(0,10))
                  .h6.m-0 #{date.getDate()}
                  .small #{day[date.getDay()]}
          //- .position-relative.mx-auto(style='line-height:50px;')
          //-   - var today = new Date();
          //-   - var m = today.getMonth() + 1;
          //-   - var d = today.getDate();
          //-   - var y = today.getFullYear();
          //-   img(src='/images/calendar_btn.png', alt='전체달력', data-date=y + '.' + m)
          //-   input#datepicker.ml-3.position-absolute(type='text', value=m + '-' + d + '-' + y)
        .mobile-menu-wrap.mx-auto
          .row
            .col-3
              .d-flex.justify-content-start
                .form-group
                  p.category 2파
                  input.bootstrap-switch(type="checkbox" data-toggle="switch" checked="" data-on-color="primary" data-off-color="primary" data-on-label="on" data-off-label="off")
                .form-group.ml-2
                  p.category 3파
                  input.bootstrap-switch(type="checkbox" data-toggle="switch" checked="" data-off-color="success" data-on-color="success" data-on-label="on" data-off-label="off")
            .col-6
              .btn-group
                button.btn.btn-warning.dropdown-toggle(type='button' data-toggle='dropdown') 전체지역
            .col-3
  // 경기장 리스트
  .container.bg-white
    .ground-list-slider
      - var d = 0;
      while d < size
        - var date = new Date();
        - date.setDate(today.getDate() + d++)
        section.ground-list(data-date=date)
          ul.list-group.list-group-flush.text-center
            if(d===1)
              if(list.length > 0)
                each game, idx in list
                  //a.mx-auto(href='#', style='width:790px;', class=idx%2===0?'bg-light':'')
                  li.list-group-item.list-group-item-light.py-1.px-0.mx-auto(style='border:none !important', class=idx%2===0?'bg-light':'')
                    //.d-flex.justify-content-between.
                    .row.w-100.m-0
                      .col-4.col-md-2.d-block
                        small.font-weight-bold.text-secondary TIME
                        h5.text-orange #{game.match_time}
                      .col-8.col-md-7.text-left
                        small.text-secondary.font-weight-bold #{game.ground_info.groundName}
                        .d-flex.justify-content-start
                          .match-wrap.text-center.pt-1
                            img(src=game.match_type==="2"?'/images/match_2.png':'/images/match_3.png')
                            b #{game.match_type==="2"?'2파':'3파'}
                          .text-left.text-dark
                            small.pl-2.tagList(class=game.sex===1?'male text-primary':game.sex===-1?'female text-danger':'mix')
                              case game.sex
                                when 1
                                  | 남성매치
                                when -1
                                  | 여성매치
                                when 0
                                  | 혼성매치
                          .grade_icon.ml-2(data-grade=game.match_grade) 실력
                          if(game.ladder===1)
                            .ladder_icon.ml-2 승점
                      - var status ='available';
                      - var remains = game.personnel.max - (game.apply_member.length || 0);
                      if(remains >= 4)
                        - status = 'available'
                      else if(remains >= 1 && remains < 4)
                        - status = 'hurry'
                      else
                        - status = 'full'
                      .col.col-md-3.p-0(style='width:160px;', data-cnt=remains, data-id=game._id)
                        if(status === 'hurry')
                          button.btn.btn-status.text-white.p-0(data-status='hurry')
                            h5.m-0.py-1 마감임박
                            .text-warning.bg-white.mx-auto.font-weight-bold(style='border-radius:1rem; width:100px; font-size:13px;') #{remains}자리 남음
                            small.position-relative(style='top:-3px;') #{new Intl.NumberFormat().format(game.match_price)}원
                        else if(status === 'available')
                          button.btn.btn-status.text-white.p-0(data-status='available')
                            h5.m-0.py-1 신청가능
                            .text-primary.bg-white.mx-auto.font-weight-bold(style='border-radius:1rem; width:100px; font-size:13px;') #{remains}자리 남음
                            small.position-relative(style='top:-3px;') #{new Intl.NumberFormat().format(game.match_price)}원
                        else if(status === 'full')
                          button.btn.btn-status.text-white(data-status='full')
                            small.m-0 마  감

              else
                li.list-group-item.list-group-item-light.py-1.px-0.mx-auto
                  .row.w-100.m-0
                    .col-12.text-center
                      p 아직 등록된 일정이 없습니다.
  include modals/filter
block append_js
  script(src='/public_js/main.js', type='text/javascript')
  script.
    var offset = $('.navigation').offset();
    var navParent = $('.navigation');
    var nav = navParent.find('nav');
    var tmp = navParent.find('nav').clone().attr('class', 'tmp').css('visibility', 'hidden'); 

    window.addEventListener('scroll', function() {
      if (window.pageYOffset > offset.top) {
        navParent.append(tmp);
        nav.css({'position': 'fixed', 'top': 0});
      } else {
        navParent.find('.tmp').remove();
        nav.css({'position': 'static', 'top': ''});
      }
    });
    $('.bootstrap-switch').bootstrapSwitch()